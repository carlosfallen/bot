<!-- FILE: public/index.html -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Imp√©rio Lord - Central de Vendas</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="app-layout">
        <aside class="sidebar">
            <div class="brand-header">
                <div class="brand-logo">
                    <div class="brand-icon">üëë</div>
                    <div class="brand-text">
                        <h1>Imp√©rio Lord</h1>
                        <span>Central de Vendas</span>
                    </div>
                </div>
            </div>

            <nav class="nav-menu">
                <div class="nav-section-label">Principal</div>
                <a class="nav-item active" data-page="dashboard"><span class="nav-icon">üìä</span>Dashboard</a>
                <a class="nav-item" data-page="conversations"><span class="nav-icon">üí¨</span>Conversas<span class="nav-badge" id="unread-badge" style="display:none">0</span></a>
                <a class="nav-item" data-page="leads"><span class="nav-icon">üë•</span>Leads</a>
                <a class="nav-item" data-page="deals"><span class="nav-icon">üí∞</span>Neg√≥cios</a>
                <a class="nav-item" data-page="appointments"><span class="nav-icon">üìÖ</span>Agenda</a>

                <div class="nav-section-label">Controles</div>
                <a class="nav-item" data-page="filters"><span class="nav-icon">üîí</span>Filtros</a>
                <a class="nav-item" data-page="quick-replies"><span class="nav-icon">‚ö°</span>Respostas R√°pidas</a>

                <div class="nav-section-label">Ferramentas</div>
                <a class="nav-item" data-page="test-nlp"><span class="nav-icon">üß†</span>Testar NLP</a>
                <a class="nav-item" data-page="test-gemini"><span class="nav-icon">‚ú®</span>Testar Gemini</a>

                <div class="nav-section-label">Sistema</div>
                <a class="nav-item" data-page="config"><span class="nav-icon">‚öôÔ∏è</span>Configura√ß√µes</a>
                <a class="nav-item" data-page="activity"><span class="nav-icon">üìã</span>Atividades</a>
            </nav>

            <div class="connection-widget">
                <div class="connection-status">
                    <div class="status-indicator" id="status-dot"></div>
                    <div class="status-info">
                        <div class="label">WhatsApp</div>
                        <div class="value" id="status-text">Verificando...</div>
                    </div>
                </div>
            </div>
        </aside>

        <main class="main-content">
            <div class="top-bar">
                <div class="page-header">
                    <h2 id="page-title">Dashboard</h2>
                    <p id="page-subtitle">Vis√£o geral do seu funil de vendas</p>
                </div>
                <div class="top-actions">
                    <button class="btn btn-secondary" onclick="loadAllData()">üîÑ Atualizar</button>
                </div>
            </div>

            <div class="page-container">
                <!-- DASHBOARD -->
                <div id="page-dashboard" class="page active">
                    <div class="sales-metrics-grid">
                        <div class="metric-card revenue"><div class="metric-header"><div class="metric-icon">üí∞</div></div><div class="metric-value" id="metric-revenue">R$ 0</div><div class="metric-label">Receita Pipeline</div></div>
                        <div class="metric-card leads"><div class="metric-header"><div class="metric-icon">üë•</div></div><div class="metric-value" id="metric-leads">0</div><div class="metric-label">Novos Leads Hoje</div></div>
                        <div class="metric-card conversion"><div class="metric-header"><div class="metric-icon">üìà</div></div><div class="metric-value" id="metric-conversion">0%</div><div class="metric-label">Taxa Resposta</div></div>
                        <div class="metric-card messages"><div class="metric-header"><div class="metric-icon">üí¨</div></div><div class="metric-value" id="metric-messages">0</div><div class="metric-label">Mensagens Hoje</div></div>
                    </div>
                    <div class="dashboard-grid">
                        <div class="widget">
                            <div class="widget-header"><span class="widget-title">üìä Pipeline</span></div>
                            <div class="widget-body">
                                <div class="pipeline-stages" id="pipeline-stages"></div>
                            </div>
                        </div>
                        <div class="widget">
                            <div class="widget-header"><span class="widget-title">üî• Conversas Recentes</span></div>
                            <div class="widget-body" id="recent-conversations"></div>
                        </div>
                    </div>
                    <div class="widget" style="margin-top:20px">
                        <div class="widget-header"><span class="widget-title">üìÖ Agenda de Hoje</span></div>
                        <div class="widget-body" id="today-appointments"></div>
                    </div>
                </div>

                <!-- CONVERSATIONS -->
                <div id="page-conversations" class="page">
                    <div class="conversations-layout">
                        <div class="conversations-sidebar">
                            <div class="search-box">
                                <input type="text" class="search-input" placeholder="Buscar..." id="search-conversations" oninput="filterConversations()">
                            </div>
                            <div class="filter-tabs" style="padding:8px">
                                <button class="filter-tab active" data-filter="all" onclick="filterConversationType('all')">Todas</button>
                                <button class="filter-tab" data-filter="unread" onclick="filterConversationType('unread')">N√£o lidas</button>
                                <button class="filter-tab" data-filter="favorite" onclick="filterConversationType('favorite')">Favoritas</button>
                            </div>
                            <div class="conversations-list" id="conversations-list"></div>
                        </div>
                        <div class="chat-area">
                            <div class="chat-empty" id="chat-empty"><div><div class="empty-state-icon">üí¨</div><p>Selecione uma conversa</p></div></div>
                            <div id="chat-container" class="hidden">
                                <div class="chat-header">
                                    <div class="conv-avatar" id="chat-avatar">?</div>
                                    <div class="chat-contact-info">
                                        <div class="chat-contact-name" id="chat-contact-name">Contato</div>
                                        <div class="chat-contact-status" id="chat-contact-status"></div>
                                    </div>
                                    <div class="chat-actions">
                                        <button class="btn btn-secondary btn-sm" id="toggle-bot-btn" onclick="toggleBotForChat()">ü§ñ Bot Ativo</button>
                                        <button class="btn btn-secondary btn-sm" onclick="toggleFavorite()">‚≠ê</button>
                                        <button class="btn btn-secondary btn-sm" onclick="blockChat()">üö´</button>
                                    </div>
                                </div>
                                <div class="chat-messages" id="chat-messages"></div>
                                <div class="chat-input-area">
                                    <select id="quick-reply-select" onchange="insertQuickReply()" style="width:120px;padding:8px;border-radius:6px;background:var(--bg-tertiary);border:1px solid var(--border);color:var(--text-primary)">
                                        <option value="">‚ö° R√°pidas</option>
                                    </select>
                                    <input type="text" class="chat-input" placeholder="Digite..." id="chat-input" onkeypress="if(event.key==='Enter')sendChatMessage()">
                                    <button class="btn btn-primary" onclick="sendChatMessage()">Enviar</button>
                                </div>
                            </div>
                        </div>
                        <div class="lead-panel" id="lead-panel" style="display:none">
                            <div class="lead-panel-header"><h3>Detalhes do Lead</h3><button onclick="closeLeadPanel()">‚úï</button></div>
                            <div class="lead-panel-body" id="lead-panel-body"></div>
                        </div>
                    </div>
                </div>

                <!-- LEADS -->
                <div id="page-leads" class="page">
                    <div class="leads-toolbar">
                        <input type="text" class="search-input" placeholder="Buscar leads..." id="search-leads" oninput="filterLeads()" style="width:300px">
                        <div class="filter-tabs">
                            <button class="filter-tab active" data-filter="all" onclick="filterLeadStatus('all')">Todos</button>
                            <button class="filter-tab" data-filter="new" onclick="filterLeadStatus('new')">Novos</button>
                            <button class="filter-tab" data-filter="hot" onclick="filterLeadStatus('hot')">Quentes</button>
                        </div>
                        <div style="flex:1"></div>
                        <button class="btn btn-primary" onclick="openLeadModal()">+ Novo Lead</button>
                    </div>
                    <div class="leads-table-container">
                        <table class="leads-table">
                            <thead><tr><th>Lead</th><th>Telefone</th><th>Empresa</th><th>Status</th><th>Temperatura</th><th>√öltima Intera√ß√£o</th><th>A√ß√µes</th></tr></thead>
                            <tbody id="leads-tbody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- DEALS -->
                <div id="page-deals" class="page">
                    <div class="deals-toolbar">
                        <div class="filter-tabs">
                            <button class="filter-tab active" onclick="filterDeals('all')">Todos</button>
                            <button class="filter-tab" onclick="filterDeals('open')">Abertos</button>
                            <button class="filter-tab" onclick="filterDeals('won')">Ganhos</button>
                            <button class="filter-tab" onclick="filterDeals('lost')">Perdidos</button>
                        </div>
                        <div style="flex:1"></div>
                        <button class="btn btn-primary" onclick="openDealModal()">+ Novo Neg√≥cio</button>
                    </div>
                    <div class="deals-grid" id="deals-grid"></div>
                </div>

                <!-- APPOINTMENTS -->
                <div id="page-appointments" class="page">
                    <div class="appointments-toolbar">
                        <button class="btn btn-primary" onclick="openAppointmentModal()">+ Novo Agendamento</button>
                    </div>
                    <div class="appointments-list" id="appointments-list"></div>
                </div>

                <!-- FILTERS -->
                <div id="page-filters" class="page">
                    <div class="filters-layout">
                        <div class="config-section">
                            <div class="config-section-header"><h3>üîí Controle de Grupos</h3></div>
                            <div class="config-section-body">
                                <div class="config-row">
                                    <div class="config-row-info"><h4>Responder em Grupos</h4><p>Bot responde em grupos do WhatsApp</p></div>
                                    <label class="toggle-switch"><input type="checkbox" id="filter-respond-groups" onchange="saveFilterConfig()"><span class="toggle-slider"></span></label>
                                </div>
                                <div class="config-row">
                                    <div class="config-row-info"><h4>Usar Whitelist de Grupos</h4><p>S√≥ responde em grupos listados abaixo</p></div>
                                    <label class="toggle-switch"><input type="checkbox" id="filter-whitelist-groups" onchange="saveFilterConfig()"><span class="toggle-slider"></span></label>
                                </div>
                                <div id="groups-whitelist" style="margin-top:16px">
                                    <h4 style="margin-bottom:12px">Grupos Liberados</h4>
                                    <div class="add-filter-form">
                                        <input type="text" id="new-group-id" placeholder="ID do grupo (ex: 123456789@g.us)" style="flex:1">
                                        <input type="text" id="new-group-name" placeholder="Nome (opcional)" style="width:200px">
                                        <button class="btn btn-success" onclick="addGroupFilter()">Adicionar</button>
                                    </div>
                                    <div class="filters-list" id="groups-list"></div>
                                </div>
                            </div>
                        </div>

                        <div class="config-section">
                            <div class="config-section-header"><h3>üö´ Bloqueio de N√∫meros</h3></div>
                            <div class="config-section-body">
                                <div class="config-row">
                                    <div class="config-row-info"><h4>Usar Blacklist de N√∫meros</h4><p>Bloqueia n√∫meros espec√≠ficos</p></div>
                                    <label class="toggle-switch"><input type="checkbox" id="filter-blacklist-numbers" onchange="saveFilterConfig()"><span class="toggle-slider"></span></label>
                                </div>
                                <div id="numbers-blacklist" style="margin-top:16px">
                                    <h4 style="margin-bottom:12px">N√∫meros Bloqueados</h4>
                                    <div class="add-filter-form">
                                        <input type="text" id="new-number" placeholder="N√∫mero (ex: 5511999999999)" style="flex:1">
                                        <input type="text" id="new-number-reason" placeholder="Motivo (opcional)" style="width:200px">
                                        <button class="btn btn-danger" onclick="addNumberFilter()">Bloquear</button>
                                    </div>
                                    <div class="filters-list" id="numbers-list"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- QUICK REPLIES -->
                <div id="page-quick-replies" class="page">
                    <div class="quick-replies-toolbar">
                        <button class="btn btn-primary" onclick="openQuickReplyModal()">+ Nova Resposta R√°pida</button>
                    </div>
                    <div class="quick-replies-grid" id="quick-replies-grid"></div>
                </div>

                <!-- TEST NLP -->
                <div id="page-test-nlp" class="page">
                    <div class="test-layout">
                        <div class="test-chat-panel">
                            <div class="test-chat-header"><h3>üß† Simulador NLP</h3></div>
                            <div class="test-messages" id="nlp-messages"><div class="message incoming">Digite mensagens para testar o NLP.</div></div>
                            <div class="test-input-area">
                                <input type="text" class="test-input" id="nlp-input" placeholder="Digite..." onkeypress="if(event.key==='Enter')testNLP()">
                                <button class="btn btn-primary" onclick="testNLP()">Testar</button>
                            </div>
                        </div>
                        <div class="analysis-panel">
                            <div class="analysis-header"><h3>üìä An√°lise</h3></div>
                            <div class="analysis-content" id="nlp-analysis"><div class="empty-state"><p>Envie uma mensagem</p></div></div>
                        </div>
                    </div>
                </div>

                <!-- TEST GEMINI -->
                <div id="page-test-gemini" class="page">
                    <div class="gemini-layout">
                        <div class="gemini-config-panel">
                            <div class="config-card">
                                <div class="config-card-header">üîß Status Gemini</div>
                                <div class="config-card-body">
                                    <div class="config-grid" id="gemini-status-grid"></div>
                                </div>
                            </div>
                            <div class="config-card">
                                <div class="config-card-header">üéØ Testar</div>
                                <div class="config-card-body">
                                    <select class="model-selector" id="model-selector"></select>
                                    <button class="btn btn-success" style="width:100%" onclick="testGeminiConnection()">üß™ Testar</button>
                                    <div class="test-result-box hidden" id="gemini-test-result"></div>
                                </div>
                            </div>
                        </div>
                        <div class="gemini-chat-panel">
                            <div class="gemini-chat-header"><h3>‚ú® Chat Gemini</h3></div>
                            <div class="gemini-messages" id="gemini-messages"><div class="gemini-msg bot">Ol√°! Sou o assistente.</div></div>
                            <div class="gemini-input-area">
                                <input type="text" class="gemini-input" id="gemini-input" placeholder="Digite..." onkeypress="if(event.key==='Enter')sendGeminiMessage()">
                                <button class="btn btn-primary" onclick="sendGeminiMessage()">Enviar</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CONFIG -->
                <div id="page-config" class="page">
                    <div class="config-layout" id="config-sections"></div>
                    <button class="btn btn-primary" onclick="saveAllConfig()" style="margin-top:16px">üíæ Salvar Tudo</button>
                </div>

                <!-- ACTIVITY -->
                <div id="page-activity" class="page">
                    <div class="activity-list" id="activity-list"></div>
                </div>
            </div>
        </main>
    </div>

    <!-- MODALS -->
    <div class="modal-overlay" id="modal-overlay" onclick="closeModal()"></div>
    <div class="modal" id="modal">
        <div class="modal-header"><h3 id="modal-title">Modal</h3><button onclick="closeModal()">‚úï</button></div>
        <div class="modal-body" id="modal-body"></div>
        <div class="modal-footer" id="modal-footer"></div>
    </div>

    <script src="/js/app.js"></script>
</body>
</html>